script:
  - scene: arrival_at_ryokan
  - scene: guest_introductions
  - scene: contract_fracture
  - scene: last_service
  - scene: incident_trigger
  - scene: lockdown_aftershock
  - scene: chapter_handoff

scenes:
  arrival_at_ryokan:
    actions:
      - bg: tea_room
      - char:
          id: 란
          position: left
      - char:
          id: 코난
          position: center
      - char:
          id: 코고로
          position: right
          emotion: proud
      - say:
          char: 란
          with:
            - 코난
            - 코고로.proud
          text: "차 향 진짜 좋다. 다 같이 모여서 이런 자리 가진 거 오랜만이야."
      - say:
          char: 코고로.proud
          with:
            - 란
          text: "오늘은 내가 특별 초청 손님이니까 말이야! 하하!"
      - say:
          char: 코난.think
          with:
            - 란
            - 코고로.proud
          text: "(겉으론 평화롭다. 문제는 이 평화가 얼마나 갈지야.)"

  guest_introductions:
    actions:
      - bg: tea_room
      - char:
          id: 켄지
          position: left
      - char:
          id: 신이치
          position: center
      - char:
          id: 레이코
          position: right
      - say:
          char: 레이코
          with:
            - 켄지
            - 신이치
          text: "오늘 모임은 공동 블렌드 공개랑 계약 최종 확인을 같이 하는 자리예요."
      - say:
          char: 켄지
          with:
            - 레이코
            - 신이치
          text: "판매 일정만 맞추면 바로 출시야. 첫 잔은 다 같이 마시자고."
      - say:
          char: 신이치.cold
          with:
            - 레이코
            - 켄지
          text: "좋습니다. 문서 확인 후 시음 순서대로 진행하죠."
      - char:
          id: 하루오
          position: right
      - say:
          char: 하루오
          with:
            - 코난
          text: "...주전자 온도도 맞춰뒀습니다. 바로 올릴 수 있어요."

  contract_fracture:
    actions:
      - music: reasoning
      - char:
          id: 신이치
          position: right
          emotion: cold
      - char:
          id: 레이코
          position: left
          emotion: nervous
      - char:
          id: 켄지
          position: center
          emotion: angry
      - sound: notebook_flip
      - say:
          text: "그때, 계약서 마지막 장의 문구 하나가 분위기를 끊었다."
      - say:
          char: 켄지.angry
          with:
            - 레이코.nervous
            - 신이치.cold
          text: "계약서 누가 건드렸어? 소유권 조항이 왜 바뀌어 있냐고!"
      - say:
          char: 레이코.nervous
          with:
            - 켄지.angry
          text: "저도 방금 처음 봤어요... 노트 날짜까지 전부 틀어져 있어요."
      - say:
          char: 신이치.cold
          with:
            - 레이코.nervous
          text: "고성은 그쯤 하시죠. 차부터 식기 전에 마십시다."
      - say:
          char: 코난.think
          text: "(다툼은 크게 보였고, 누군가는 그 틈을 기다렸다.)"

  last_service:
    actions:
      - bg: tea_room
      - char:
          id: 코난
          position: center
          emotion: think
      - char:
          id: 하루오
          position: right
          emotion: scared
      - say:
          text: "분위기를 누그러뜨리려 다실 주인은 마지막 잔을 직접 준비했다."
      - say:
          text: "주전자 뚜껑을 한 번... 그리고 또 한 번 눌렀다."
      - say:
          char: 하루오.scared
          with:
            - 코난.think
          text: "...그 직후였어. 누가 손수건으로 피해자 찻잔 가장자리를 훑고 빠졌어."
      - say:
          char: 코난.think
          text: "(뚜껑 두 번, 잔 가장자리... 하나는 진짜고 하나는 미끼다.)"
      - wait: 360

  incident_trigger:
    actions:
      - wait: 220
      - sound: scream
      - effect: flash
      - effect: darken
      - char:
          id: 란
          position: left
          emotion: surprised
      - say:
          char: 란.surprised
          with:
            - 코난.serious
          text: "꺄악! 안쪽에서 사람 쓰러지는 소리 났어!"
      - sound: thunder
      - say:
          char: 코고로.angry
          with:
            - 란.surprised
            - 코난.serious
          text: "전원 멈춰! 찻상, 문고리, 아무것도 건드리지 마!"

  lockdown_aftershock:
    actions:
      - bg: ryokan_hall
      - sticker:
          id: tape_lock
          image: police_tape
          x: 50
          y: 52
          width: 92
          anchorX: center
          anchorY: center
          zIndex: 5
          enter:
            effect: wipeCenterX
            duration: 420
      - say:
          char: 코난.serious
          with:
            - 코고로.angry
          text: "문은 안에서 잠겼고 창도 막혀 있어. 겉으로 보면 완벽한 밀실이야."
      - say:
          char: 코고로.angry
          with:
            - 코난.serious
          text: "좋아, 다들 들었지? 지금부터는 내 지시대로 움직여!"
      - add:
          deduction_score: 1
      - clearSticker:
          id: tape_lock
          leave:
            effect: wipeRight
            duration: 260
      - effect: zoom
      - say:
          char: 코난.think
          text: "(하지만 답은 문에 없고, 찻잔 위에 남아 있어.)"

  chapter_handoff:
    actions:
      - effect: pulse
      - say:
          char: 코난
          text: "좋아, 초동 정리 들어간다. 시간부터 다시 맞춰 보자."
      - goto: ./2.yaml
