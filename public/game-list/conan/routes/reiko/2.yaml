meta:
  title: "명탐정 코난 외전: 다실의 비밀"
  author: "uiwwsw"
  version: "4.0"

settings:
  textSpeed: 38
  autoSave: true
  clickToInstant: true

assets:
  backgrounds:
    mountain_rain: ../../assets/bg/mountain_rain.png
    tea_room: ../../assets/bg/tea_room.png

  characters:
    코난:
      base: ../../assets/char/conan/base.png
      emotions:
        think: ../../assets/char/conan/think.png
        serious: ../../assets/char/conan/serious.png

    신이치:
      base: ../../assets/char/shinichi/base.png
      emotions:
        cold: ../../assets/char/shinichi/cold.png

    레이코:
      base: ../../assets/char/reiko/base.png
      emotions:
        nervous: ../../assets/char/reiko/nervous.png

    코고로:
      base: ../../assets/char/kogoro/base.png
      emotions:
        angry: ../../assets/char/kogoro/angry.png

  music:
    mystery: ../../assets/music/mystery.wav
    tension: ../../assets/music/tension.wav

state:
  defaults:
    trust: 0
    truth_point: 0
    mistake_count: 0
    comeback_chance: 1
    route_origin: ""
    suspect: ""
    culprit_answer: ""

script:
  - scene: pressure_start
  - scene: cross_gate
  - scene: detour_gate
  - scene: final_note
  - scene: route_outro

scenes:
  pressure_start:
    actions:
      - bg: mountain_rain
      - music: tension
      - char:
          id: 코난
          position: center
          emotion: serious
      - char:
          id: 코고로
          position: right
          emotion: angry
      - say:
          text: "레이코 루트 2 - 역추적"
      - say:
          char: 코난.serious
          text: "초반엔 틀렸어도, 지금 정확한 선택을 하면 다시 기회를 만들 수 있어."
      - goto: cross_gate

  cross_gate:
    actions:
      - bg: tea_room
      - char:
          id: 신이치
          position: right
          emotion: cold
      - char:
          id: 레이코
          position: left
          emotion: nervous
      - choice:
          key: reiko_route2_cross
          prompt: "교차 검증의 중심을 어디에 둘까?"
          options:
            - text: "찻잎 성분표로 신이치 알리바이를 붕괴시킨다"
              set:
                suspect: "신이치"
              add:
                truth_point: 1
                trust: 1
              goto: final_note
            - text: "초기 인상대로 레이코를 주범으로 고정한다"
              set:
                suspect: "레이코"
              add:
                mistake_count: 1
                trust: -1
              goto: detour_gate

  detour_gate:
    actions:
      - effect: shake
      - say:
          text: "핵심과 주변 정황이 섞이며 보고서가 흔들렸다."
      - choice:
          key: reiko_route2_detour
          prompt: "마지막으로 다시 확인할 단서를 고르자."
          options:
            - text: "문틈 줄 마찰흔을 재검토한다"
              set:
                suspect: "신이치"
              add:
                truth_point: 1
                trust: 1
              goto: final_note
            - text: "레이코의 불안한 손짓만 근거로 유지한다"
              set:
                suspect: "레이코"
              add:
                mistake_count: 1
                trust: -1
              goto: final_note

  final_note:
    actions:
      - char:
          id: 코난
          position: center
          emotion: think
      - say:
          text: "이제 결론 회의에서 누가 논리로 버틸지 결정된다."
      - goto: route_outro

  route_outro:
    actions:
      - goto: ./conclusion/1.yaml
